'use strict'

module.exports = {
  state: {
    messages: {
      error: [],
      success: []
    }
  },
  getters: {
    messages (state) {
      return state.messages
    }
  },
  actions: {
    messages_set_error (store, payload) {
      store.commit('MESSAGES_SET', {type: 'error', id: payload.id, message: payload.message})
    },
    messages_set_success (store, payload) {
      store.commit('MESSAGES_SET', {type: 'success', id: payload.id, message:payload.message})
      setTimeout(() => {
        store.commit('MESSAGES_REMOVE', {type: 'success', id: payload.id})
      }, 5000)
    }
  },
  mutations: {
    MESSAGES_SET (state, payload) {
      state.messages[payload.type].push({id: payload.id, message: payload.message})
    },
    MESSAGES_REMOVE (state, payload) {
      var messages = state.messages[payload.type]
      for (var i = 0; i < messages.length; i++) {
        if(messages[i].id.indexOf(payload.id) > -1) {
          messages.splice(i, 1)
        }
      }
    }
  }
}
